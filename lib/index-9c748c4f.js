"use strict";var e=require("atom"),t=require("os"),n="linter-makensis",o={schema:{pathToMakensis:{title:"Path to MakeNSIS",description:"Specify the full path to `makensis`",type:"string",default:"makensis",order:1},preprocessMode:{title:"Pre-process Mode",description:"Linter runs in the much faster pre-process mode, but ignores warning (unless in strict mode)",type:"string",default:"Safe PPO",enum:["(none)","PPO","Safe PPO"],order:2},strictMode:{title:"Strict Mode",description:"Treats warnings as errors, requires NSIS v3.0 (or higher)",type:"boolean",default:!1,order:3},overrideCompression:{title:"Override Compression",description:"Overrides compressions settings in script in order to speed up linting process",type:"boolean",default:!0,order:4},manageDependencies:{title:"Manage Dependencies",description:"When enabled, third-party dependencies will be installed automatically",type:"boolean",default:!0,order:6},advanced:{title:"Advanced Settings",type:"object",order:7,properties:{preExecute:{title:"Prepend code",description:"Comma-separated list of commands to be prepended to your script",type:"array",items:{type:"string"},default:[],order:1},postExecute:{title:"Append code",description:"Comma-separated list of commands to be appended to your script",type:"array",items:{type:"string"},default:[],order:2},useWine:{title:"Use Wine",description:"When on a non-Windows platform, you can compile installers using [Wine](https://www.winehq.org/). Make sure to set up `pathToMakensis` accordingly or add `makensis` to the Wine's PATH environmental variable.",type:"boolean",default:!1,order:3},muteANSIDeprecationWarning:{title:"Mute Deprecation Warning",description:"Mutes ANSI deprecation warning introduced in NSIS v3.05",type:"boolean",default:!1,order:4},clearConsole:{title:"Clear Console",description:"Clears the console prior to linting. Only works when in developer mode.",type:"boolean",default:!1,order:5}}}},get:(e="")=>e?.length?atom.config.get(`${n}.${e}`):atom.config.get(`${n}`),migrate(e,t){if(atom.config.get(`${n}.${e}`)&&!atom.config.get(`${n}.${t}`)){try{atom.config.set(`${n}.${t}`,atom.config.get(`${n}.${e}`))}catch(e){return void atom.notifications.addWarning("Failed to migrate configuration, see console for details")}atom.config.unset(`${n}.${e}`)}},unset(e=""){const t=e?.length?`${n}.${e}`:n;atom.config.unset(t)},async open(e={}){e={pending:!0,searchAllPanes:!0,...e},await atom.workspace.open(`atom://config/packages/${n}`,e)}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function i(e,t){for(var n=0,o=t.length,i=e.length;n<o;n++,i++)e[i]=t[n];return e}var r=new(function(){function e(e){void 0===e&&(e={}),this.name=e.name,this.styleSheet="\n      background-color: "+(e.backgroundColor||"darkgrey")+";\n      border-radius: 2px;\n      color: "+(e.color||"white")+";\n      line-height: 1.5;\n      padding: 1px 4px;\n      text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);\n    "}return e.prototype.__console__=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(null===atom||void 0===atom?void 0:atom.inDevMode())&&(n.unshift("%c"+this.name+"%c",this.styleSheet,""),(t=window.console)[e].apply(t,n))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,i(["debug"],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,i(["error"],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,i(["info"],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,i(["log"],e))},e.prototype.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,i(["trace"],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,i(["warn"],e))},e}())({name:n,backgroundColor:"darkorange"}),s={config:o.schema,async activate(){if(this.subscriptions=new e.CompositeDisposable,this.subscriptions.add(atom.commands.add("atom-workspace",{"linter-MakeNSIS:open-settings":()=>o.open()})),this.subscriptions.add(atom.commands.add("atom-workspace",{"linter-MakeNSIS:satisfy-dependencies":async()=>{const{satisfyDependencies:e}=await Promise.resolve().then((function(){return require("./index-7f37b972.js")})).then((function(e){return e.index}));e(n)}})),!atom.inSpecMode()&&o.get("manageDependencies")){const{satisfyDependencies:e}=await Promise.resolve().then((function(){return require("./index-7f37b972.js")})).then((function(e){return e.index}));e(n)}this.cleanUp()},deactivate(){this.subscriptions?.dispose(),this.subscriptions=null},cleanUp(){atom.config.unset("linter-makensis.ppoMode")},provideLinter:()=>({name:"linter-makensis",grammarScopes:["source.nsis"],scope:"file",lintsOnChange:!1,lint:async e=>{const n=e.getPath(),i=e.getText(),s=o.get("advanced.preExecute"),a=o.get("advanced.postExecute"),c=!("win32"===t.platform()||!o.get("advanced.useWine")),p={preExecute:Array.isArray(s)?s:[],postExecute:Array.isArray(a)?a:[],PPO:null,safePPO:null,pathToMakensis:o.get("pathToMakensis"),strict:o.get("strictMode"),verbose:2,wine:c},d="win32"===t.platform()?"NUL":"/dev/null/";switch(String(o.get("preprocessMode")).trim()){case"PPO":p.PPO=!0;break;case"Safe PPO":p.safePPO=!0;break;default:p.postExecute.push(`OutFile ${d}`)}o.get("overrideCompression")&&(p.preExecute.unshift("SetCompressor /FINAL zlib"),p.postExecute.push("SetCompress off")),o.get("advanced.clearConsole")&&r.clear();const{compile:l}=await Promise.resolve().then((function(){return require("./makensis-d23e36ba.js")})).then((function(e){return e.makensis})),u=await l(n,p);if(r.info("Compiler Options:",p),r.info("Output:",u),e.getText()!==i)return r.warn("File has changed since the lint was triggered"),null;const g=[];if(u.stdout){const{findWarnings:t}=await Promise.resolve().then((function(){return require("./util-06104626.js")})),n=await t(e,u.stdout,p);n&&g.push(...n)}if(u.stderr){const{findErrors:t}=await Promise.resolve().then((function(){return require("./util-06104626.js")})),n=await t(e,u.stderr);n&&g.push(...n)}return 0===g.length?null:g}})};exports.config=o,exports.index=s,exports.name=n;
//# sourceMappingURL=index-9c748c4f.js.map
