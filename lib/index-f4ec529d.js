"use strict";var e=require("atom"),t=require("os"),n=require("util"),r=require("path");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=o(n),a=o(r),i="linter-makensis",u={schema:{pathToMakensis:{title:"Path to MakeNSIS",description:"Specify the full path to `makensis`",type:"string",default:"makensis",order:1},preprocessMode:{title:"Pre-process Mode",description:"Linter runs in the much faster pre-process mode, but ignores warning (unless in strict mode)",type:"string",default:"Safe PPO",enum:["(none)","PPO","Safe PPO"],order:2},strictMode:{title:"Strict Mode",description:"Treats warnings as errors, requires NSIS v3.0 (or higher)",type:"boolean",default:!1,order:3},overrideCompression:{title:"Override Compression",description:"Overrides compressions settings in script in order to speed up linting process",type:"boolean",default:!0,order:4},excludedFiles:{title:"Excluded Files",description:"Specify files that will be excluded from linting. Supports [glob patterns](https://github.com/micromatch/micromatch#matching-features).",type:"array",items:{type:"string"},default:[],order:5},lintsOnChange:{title:"Lints on Change",description:"Lints whenever your code has changed, rather than when the document has been saved",type:"boolean",default:!1,order:6},manageDependencies:{title:"Manage Dependencies",description:"When enabled, third-party dependencies will be installed automatically",type:"boolean",default:!0,order:7},advanced:{title:"Advanced Settings",type:"object",order:8,properties:{preExecute:{title:"Prepend code",description:"Comma-separated list of commands to be prepended to your script",type:"array",items:{type:"string"},default:[],order:1},postExecute:{title:"Append code",description:"Comma-separated list of commands to be appended to your script",type:"array",items:{type:"string"},default:[],order:2},useWine:{title:"Use Wine",description:"When on a non-Windows platform, you can compile installers using [Wine](https://www.winehq.org/). Make sure to set up `pathToMakensis` accordingly or add `makensis` to the Wine's PATH environmental variable.",type:"boolean",default:!1,order:3},muteANSIDeprecationWarning:{title:"Mute Deprecation Warning",description:"Mutes ANSI deprecation warning introduced in NSIS v3.05",type:"boolean",default:!1,order:4},clearConsole:{title:"Clear Console",description:"Clears the console prior to linting. Only works when in developer mode.",type:"boolean",default:!1,order:5}}}},get:(e="")=>e?.length?atom.config.get(`${i}.${e}`):atom.config.get(`${i}`),migrate(e,t){if(atom.config.get(`${i}.${e}`)&&!atom.config.get(`${i}.${t}`)){try{atom.config.set(`${i}.${t}`,atom.config.get(`${i}.${e}`))}catch(e){return void atom.notifications.addWarning("Failed to migrate configuration, see console for details")}atom.config.unset(`${i}.${e}`)}},unset(e=""){const t=e?.length?`${i}.${e}`:i;atom.config.unset(t)},async open(e={}){e={pending:!0,searchAllPanes:!0,...e},await atom.workspace.open(`atom://config/packages/${i}`,e)}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function p(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}var l=new(function(){function e(e){void 0===e&&(e={}),this.name=e.name,this.styleSheet="\n      background-color: "+(e.backgroundColor||"darkgrey")+";\n      border-radius: 2px;\n      color: "+(e.color||"white")+";\n      line-height: 1.5;\n      padding: 1px 4px;\n      text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);\n    "}return e.prototype.__console__=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(null===atom||void 0===atom?void 0:atom.inDevMode())&&(n.unshift("%c"+this.name+"%c",this.styleSheet,""),(t=window.console)[e].apply(t,n))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,p(["debug"],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,p(["error"],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,p(["info"],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,p(["log"],e))},e.prototype.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,p(["trace"],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.__console__.apply(this,p(["warn"],e))},e}())({name:i,backgroundColor:"darkorange"}),c={};!function(e){e.isInteger=e=>"number"==typeof e?Number.isInteger(e):"string"==typeof e&&""!==e.trim()&&Number.isInteger(Number(e)),e.find=(e,t)=>e.nodes.find((e=>e.type===t)),e.exceedsLimit=(t,n,r=1,o)=>!1!==o&&(!(!e.isInteger(t)||!e.isInteger(n))&&(Number(n)-Number(t))/Number(r)>=o),e.escapeNode=(e,t=0,n)=>{let r=e.nodes[t];r&&(n&&r.type===n||"open"===r.type||"close"===r.type)&&!0!==r.escaped&&(r.value="\\"+r.value,r.escaped=!0)},e.encloseBrace=e=>"brace"===e.type&&(e.commas>>0+e.ranges>>0==0&&(e.invalid=!0,!0)),e.isInvalidBrace=e=>"brace"===e.type&&(!(!0!==e.invalid&&!e.dollar)||(e.commas>>0+e.ranges>>0==0||!0!==e.open||!0!==e.close)&&(e.invalid=!0,!0)),e.isOpenOrClose=e=>"open"===e.type||"close"===e.type||(!0===e.open||!0===e.close),e.reduce=e=>e.reduce(((e,t)=>("text"===t.type&&e.push(t.value),"range"===t.type&&(t.type="text"),e)),[]),e.flatten=(...e)=>{const t=[],n=e=>{for(let r=0;r<e.length;r++){let o=e[r];Array.isArray(o)?n(o):void 0!==o&&t.push(o)}return t};return n(e),t}}(c);const f=c;var d=(e,t={})=>{let n=(e,r={})=>{let o=t.escapeInvalid&&f.isInvalidBrace(r),s=!0===e.invalid&&!0===t.escapeInvalid,a="";if(e.value)return(o||s)&&f.isOpenOrClose(e)?"\\"+e.value:e.value;if(e.value)return e.value;if(e.nodes)for(let t of e.nodes)a+=n(t);return a};return n(e)};
/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */
/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */
const g=function(e){return"number"==typeof e?e-e==0:"string"==typeof e&&""!==e.trim()&&(Number.isFinite?Number.isFinite(+e):isFinite(+e))},h=(e,t,n)=>{if(!1===g(e))throw new TypeError("toRegexRange: expected the first argument to be a number");if(void 0===t||e===t)return String(e);if(!1===g(t))throw new TypeError("toRegexRange: expected the second argument to be a number.");let r={relaxZeros:!0,...n};"boolean"==typeof r.strictZeros&&(r.relaxZeros=!1===r.strictZeros);let o=e+":"+t+"="+String(r.relaxZeros)+String(r.shorthand)+String(r.capture)+String(r.wrap);if(h.cache.hasOwnProperty(o))return h.cache[o].result;let s=Math.min(e,t),a=Math.max(e,t);if(1===Math.abs(s-a)){let n=e+"|"+t;return r.capture?`(${n})`:!1===r.wrap?n:`(?:${n})`}let i=S(e)||S(t),u={min:e,max:t,a:s,b:a},p=[],l=[];if(i&&(u.isPadded=i,u.maxLen=String(u.max).length),s<0){l=R(a<0?Math.abs(a):1,Math.abs(s),u,r),s=u.a=0}return a>=0&&(p=R(s,a,u,r)),u.negatives=l,u.positives=p,u.result=function(e,t,n){let r=_(e,t,"-",!1)||[],o=_(t,e,"",!1)||[],s=_(e,t,"-?",!0)||[];return r.concat(s).concat(o).join("|")}(l,p),!0===r.capture?u.result=`(${u.result})`:!1!==r.wrap&&p.length+l.length>1&&(u.result=`(?:${u.result})`),h.cache[o]=u,u.result};function A(e,t,n){if(e===t)return{pattern:e,count:[],digits:0};let r=function(e,t){let n=[];for(let r=0;r<e.length;r++)n.push([e[r],t[r]]);return n}(e,t),o=r.length,s="",a=0;for(let e=0;e<o;e++){let[t,n]=r[e];t===n?s+=t:"0"!==t||"9"!==n?s+=b(t,n):a++}return a&&(s+=!0===n.shorthand?"\\d":"[0-9]"),{pattern:s,count:[a],digits:o}}function R(e,t,n,r){let o,s=function(e,t){let n=1,r=1,o=C(e,n),s=new Set([t]);for(;e<=o&&o<=t;)s.add(o),n+=1,o=C(e,n);for(o=m(t+1,r)-1;e<o&&o<=t;)s.add(o),r+=1,o=m(t+1,r)-1;return s=[...s],s.sort(y),s}(e,t),a=[],i=e;for(let e=0;e<s.length;e++){let t=s[e],u=A(String(i),String(t),r),p="";n.isPadded||!o||o.pattern!==u.pattern?(n.isPadded&&(p=x(t,n,r)),u.string=p+u.pattern+v(u.count),a.push(u),i=t+1,o=u):(o.count.length>1&&o.count.pop(),o.count.push(u.count[0]),o.string=o.pattern+v(o.count),i=t+1)}return a}function _(e,t,n,r,o){let s=[];for(let o of e){let{string:e}=o;r||E(t,"string",e)||s.push(n+e),r&&E(t,"string",e)&&s.push(n+e)}return s}function y(e,t){return e>t?1:t>e?-1:0}function E(e,t,n){return e.some((e=>e[t]===n))}function C(e,t){return Number(String(e).slice(0,-t)+"9".repeat(t))}function m(e,t){return e-e%Math.pow(10,t)}function v(e){let[t=0,n=""]=e;return n||t>1?`{${t+(n?","+n:"")}}`:""}function b(e,t,n){return`[${e}${t-e==1?"":"-"}${t}]`}function S(e){return/^-?(0+)\d/.test(e)}function x(e,t,n){if(!t.isPadded)return e;let r=Math.abs(t.maxLen-String(e).length),o=!1!==n.relaxZeros;switch(r){case 0:return"";case 1:return o?"0?":"0";case 2:return o?"0{0,2}":"00";default:return o?`0{0,${r}}`:`0{${r}}`}}h.cache={},h.clearCache=()=>h.cache={};var H=h;
/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const $=s.default,T=H,L=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),O=e=>"number"==typeof e||"string"==typeof e&&""!==e,w=e=>Number.isInteger(+e),k=e=>{let t=`${e}`,n=-1;if("-"===t[0]&&(t=t.slice(1)),"0"===t)return!1;for(;"0"===t[++n];);return n>0},N=(e,t,n)=>{if(t>0){let n="-"===e[0]?"-":"";n&&(e=e.slice(1)),e=n+e.padStart(n?t-1:t,"0")}return!1===n?String(e):e},I=(e,t)=>{let n="-"===e[0]?"-":"";for(n&&(e=e.slice(1),t--);e.length<t;)e="0"+e;return n?"-"+e:e},M=(e,t,n,r)=>{if(n)return T(e,t,{wrap:!1,...r});let o=String.fromCharCode(e);return e===t?o:`[${o}-${String.fromCharCode(t)}]`},P=(e,t,n)=>{if(Array.isArray(e)){let t=!0===n.wrap,r=n.capture?"":"?:";return t?`(${r}${e.join("|")})`:e.join("|")}return T(e,t,n)},B=(...e)=>new RangeError("Invalid range arguments: "+$.inspect(...e)),D=(e,t,n)=>{if(!0===n.strictRanges)throw B([e,t]);return[]},G=(e,t,n=1,r={})=>{let o=Number(e),s=Number(t);if(!Number.isInteger(o)||!Number.isInteger(s)){if(!0===r.strictRanges)throw B([e,t]);return[]}0===o&&(o=0),0===s&&(s=0);let a=o>s,i=String(e),u=String(t),p=String(n);n=Math.max(Math.abs(n),1);let l=k(i)||k(u)||k(p),c=l?Math.max(i.length,u.length,p.length):0,f=!1===l&&!1===((e,t,n)=>"string"==typeof e||"string"==typeof t||!0===n.stringify)(e,t,r),d=r.transform||(e=>t=>!0===e?Number(t):String(t))(f);if(r.toRegex&&1===n)return M(I(e,c),I(t,c),!0,r);let g={negatives:[],positives:[]},h=[],A=0;for(;a?o>=s:o<=s;)!0===r.toRegex&&n>1?g[(R=o)<0?"negatives":"positives"].push(Math.abs(R)):h.push(N(d(o,A),c,f)),o=a?o-n:o+n,A++;var R;return!0===r.toRegex?n>1?((e,t)=>{e.negatives.sort(((e,t)=>e<t?-1:e>t?1:0)),e.positives.sort(((e,t)=>e<t?-1:e>t?1:0));let n,r=t.capture?"":"?:",o="",s="";return e.positives.length&&(o=e.positives.join("|")),e.negatives.length&&(s=`-(${r}${e.negatives.join("|")})`),n=o&&s?`${o}|${s}`:o||s,t.wrap?`(${r}${n})`:n})(g,r):P(h,null,{wrap:!1,...r}):h},U=(e,t,n,r={})=>{if(null==t&&O(e))return[e];if(!O(e)||!O(t))return D(e,t,r);if("function"==typeof n)return U(e,t,1,{transform:n});if(L(n))return U(e,t,0,n);let o={...r};return!0===o.capture&&(o.wrap=!0),n=n||o.step||1,w(n)?w(e)&&w(t)?G(e,t,n,o):((e,t,n=1,r={})=>{if(!w(e)&&e.length>1||!w(t)&&t.length>1)return D(e,t,r);let o=r.transform||(e=>String.fromCharCode(e)),s=`${e}`.charCodeAt(0),a=`${t}`.charCodeAt(0),i=s>a,u=Math.min(s,a),p=Math.max(s,a);if(r.toRegex&&1===n)return M(u,p,!1,r);let l=[],c=0;for(;i?s>=a:s<=a;)l.push(o(s,c)),s=i?s-n:s+n,c++;return!0===r.toRegex?P(l,null,{wrap:!1,options:r}):l})(e,t,Math.max(Math.abs(n),1),o):null==n||L(n)?U(e,t,1,n):((e,t)=>{if(!0===t.strictRanges)throw new TypeError(`Expected step "${e}" to be a number`);return[]})(n,o)};const K=U,F=c;var W=(e,t={})=>{let n=(e,r={})=>{let o=F.isInvalidBrace(r),s=!0===e.invalid&&!0===t.escapeInvalid,a=!0===o||!0===s,i=!0===t.escapeInvalid?"\\":"",u="";if(!0===e.isOpen)return i+e.value;if(!0===e.isClose)return i+e.value;if("open"===e.type)return a?i+e.value:"(";if("close"===e.type)return a?i+e.value:")";if("comma"===e.type)return"comma"===e.prev.type?"":a?e.value:"|";if(e.value)return e.value;if(e.nodes&&e.ranges>0){let n=F.reduce(e.nodes),r=K(...n,{...t,wrap:!1,toRegex:!0});if(0!==r.length)return n.length>1&&r.length>1?`(${r})`:r}if(e.nodes)for(let t of e.nodes)u+=n(t,e);return u};return n(e)};const Q=U,q=d,X=c,j=(e="",t="",n=!1)=>{let r=[];if(e=[].concat(e),!(t=[].concat(t)).length)return e;if(!e.length)return n?X.flatten(t).map((e=>`{${e}}`)):t;for(let o of e)if(Array.isArray(o))for(let e of o)r.push(j(e,t,n));else for(let e of t)!0===n&&"string"==typeof e&&(e=`{${e}}`),r.push(Array.isArray(e)?j(o,e,n):o+e);return X.flatten(r)};var Z=(e,t={})=>{let n=void 0===t.rangeLimit?1e3:t.rangeLimit,r=(e,o={})=>{e.queue=[];let s=o,a=o.queue;for(;"brace"!==s.type&&"root"!==s.type&&s.parent;)s=s.parent,a=s.queue;if(e.invalid||e.dollar)return void a.push(j(a.pop(),q(e,t)));if("brace"===e.type&&!0!==e.invalid&&2===e.nodes.length)return void a.push(j(a.pop(),["{}"]));if(e.nodes&&e.ranges>0){let r=X.reduce(e.nodes);if(X.exceedsLimit(...r,t.step,n))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let o=Q(...r,t);return 0===o.length&&(o=q(e,t)),a.push(j(a.pop(),o)),void(e.nodes=[])}let i=X.encloseBrace(e),u=e.queue,p=e;for(;"brace"!==p.type&&"root"!==p.type&&p.parent;)p=p.parent,u=p.queue;for(let t=0;t<e.nodes.length;t++){let n=e.nodes[t];"comma"!==n.type||"brace"!==e.type?"close"!==n.type?n.value&&"open"!==n.type?u.push(j(u.pop(),n.value)):n.nodes&&r(n,e):a.push(j(a.pop(),u,i)):(1===t&&u.push(""),u.push(""))}return u};return X.flatten(r(e))};const Y=d,{MAX_LENGTH:z,CHAR_BACKSLASH:V,CHAR_BACKTICK:J,CHAR_COMMA:ee,CHAR_DOT:te,CHAR_LEFT_PARENTHESES:ne,CHAR_RIGHT_PARENTHESES:re,CHAR_LEFT_CURLY_BRACE:oe,CHAR_RIGHT_CURLY_BRACE:se,CHAR_LEFT_SQUARE_BRACKET:ae,CHAR_RIGHT_SQUARE_BRACKET:ie,CHAR_DOUBLE_QUOTE:ue,CHAR_SINGLE_QUOTE:pe,CHAR_NO_BREAK_SPACE:le,CHAR_ZERO_WIDTH_NOBREAK_SPACE:ce}={MAX_LENGTH:65536,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:"\n",CHAR_NO_BREAK_SPACE:" ",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"\t",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\ufeff"};const fe=d,de=W,ge=Z,he=(e,t={})=>{if("string"!=typeof e)throw new TypeError("Expected a string");let n=t||{},r="number"==typeof n.maxLength?Math.min(z,n.maxLength):z;if(e.length>r)throw new SyntaxError(`Input length (${e.length}), exceeds max characters (${r})`);let o,s={type:"root",input:e,nodes:[]},a=[s],i=s,u=s,p=0,l=e.length,c=0,f=0;const d=()=>e[c++],g=e=>{if("text"===e.type&&"dot"===u.type&&(u.type="text"),!u||"text"!==u.type||"text"!==e.type)return i.nodes.push(e),e.parent=i,e.prev=u,u=e,e;u.value+=e.value};for(g({type:"bos"});c<l;)if(i=a[a.length-1],o=d(),o!==ce&&o!==le)if(o!==V)if(o!==ie)if(o!==ae)if(o!==ne)if(o!==re)if(o!==ue&&o!==pe&&o!==J)if(o!==oe)if(o!==se)if(o===ee&&f>0){if(i.ranges>0){i.ranges=0;let e=i.nodes.shift();i.nodes=[e,{type:"text",value:Y(i)}]}g({type:"comma",value:o}),i.commas++}else if(o===te&&f>0&&0===i.commas){let e=i.nodes;if(0===f||0===e.length){g({type:"text",value:o});continue}if("dot"===u.type){if(i.range=[],u.value+=o,u.type="range",3!==i.nodes.length&&5!==i.nodes.length){i.invalid=!0,i.ranges=0,u.type="text";continue}i.ranges++,i.args=[];continue}if("range"===u.type){e.pop();let t=e[e.length-1];t.value+=u.value+o,u=t,i.ranges--;continue}g({type:"dot",value:o})}else g({type:"text",value:o});else{if("brace"!==i.type){g({type:"text",value:o});continue}let e="close";i=a.pop(),i.close=!0,g({type:e,value:o}),f--,i=a[a.length-1]}else{f++;let e=u.value&&"$"===u.value.slice(-1)||!0===i.dollar;i=g({type:"brace",open:!0,close:!1,dollar:e,depth:f,commas:0,ranges:0,nodes:[]}),a.push(i),g({type:"open",value:o})}else{let e,n=o;for(!0!==t.keepQuotes&&(o="");c<l&&(e=d());)if(e!==V){if(e===n){!0===t.keepQuotes&&(o+=e);break}o+=e}else o+=e+d();g({type:"text",value:o})}else{if("paren"!==i.type){g({type:"text",value:o});continue}i=a.pop(),g({type:"text",value:o}),i=a[a.length-1]}else i=g({type:"paren",nodes:[]}),a.push(i),g({type:"text",value:o});else{let e;for(p++;c<l&&(e=d());)if(o+=e,e!==ae)if(e!==V){if(e===ie&&(p--,0===p))break}else o+=d();else p++;g({type:"text",value:o})}else g({type:"text",value:"\\"+o});else g({type:"text",value:(t.keepEscaping?o:"")+d()});do{if(i=a.pop(),"root"!==i.type){i.nodes.forEach((e=>{e.nodes||("open"===e.type&&(e.isOpen=!0),"close"===e.type&&(e.isClose=!0),e.nodes||(e.type="text"),e.invalid=!0)}));let e=a[a.length-1],t=e.nodes.indexOf(i);e.nodes.splice(t,1,...i.nodes)}}while(a.length>0);return g({type:"eos"}),s},Ae=(e,t={})=>{let n=[];if(Array.isArray(e))for(let r of e){let e=Ae.create(r,t);Array.isArray(e)?n.push(...e):n.push(e)}else n=[].concat(Ae.create(e,t));return t&&!0===t.expand&&!0===t.nodupes&&(n=[...new Set(n)]),n};Ae.parse=(e,t={})=>he(e,t),Ae.stringify=(e,t={})=>fe("string"==typeof e?Ae.parse(e,t):e,t),Ae.compile=(e,t={})=>("string"==typeof e&&(e=Ae.parse(e,t)),de(e,t)),Ae.expand=(e,t={})=>{"string"==typeof e&&(e=Ae.parse(e,t));let n=ge(e,t);return!0===t.noempty&&(n=n.filter(Boolean)),!0===t.nodupes&&(n=[...new Set(n)]),n},Ae.create=(e,t={})=>""===e||e.length<3?[e]:!0!==t.expand?Ae.compile(e,t):Ae.expand(e,t);var Re=Ae,_e={};const ye=a.default,Ee={DOT_LITERAL:"\\.",PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:"\\/",ONE_CHAR:"(?=.)",QMARK:"[^/]",END_ANCHOR:"(?:\\/|$)",DOTS_SLASH:"\\.{1,2}(?:\\/|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|\\/)\\.{1,2}(?:\\/|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:\\/|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:\\/|$))",QMARK_NO_DOT:"[^.\\/]",STAR:"[^/]*?",START_ANCHOR:"(?:^|\\/)"},Ce={...Ee,SLASH_LITERAL:"[\\\\/]",QMARK:"[^\\\\/]",STAR:"[^\\\\/]*?",DOTS_SLASH:"\\.{1,2}(?:[\\\\/]|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|[\\\\/])\\.{1,2}(?:[\\\\/]|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:[\\\\/]|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:[\\\\/]|$))",QMARK_NO_DOT:"[^.\\\\/]",START_ANCHOR:"(?:^|[\\\\/])",END_ANCHOR:"(?:[\\\\/]|$)"};var me={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:ye.sep,extglobChars:e=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:e=>!0===e?Ce:Ee};!function(e){const t=a.default,n="win32"===process.platform,{REGEX_BACKSLASH:r,REGEX_REMOVE_BACKSLASH:o,REGEX_SPECIAL_CHARS:s,REGEX_SPECIAL_CHARS_GLOBAL:i}=me;e.isObject=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),e.hasRegexChars=e=>s.test(e),e.isRegexChar=t=>1===t.length&&e.hasRegexChars(t),e.escapeRegex=e=>e.replace(i,"\\$1"),e.toPosixSlashes=e=>e.replace(r,"/"),e.removeBackslashes=e=>e.replace(o,(e=>"\\"===e?"":e)),e.supportsLookbehinds=()=>{const e=process.version.slice(1).split(".").map(Number);return 3===e.length&&e[0]>=9||8===e[0]&&e[1]>=10},e.isWindows=e=>e&&"boolean"==typeof e.windows?e.windows:!0===n||"\\"===t.sep,e.escapeLast=(t,n,r)=>{const o=t.lastIndexOf(n,r);return-1===o?t:"\\"===t[o-1]?e.escapeLast(t,n,o-1):`${t.slice(0,o)}\\${t.slice(o)}`},e.removePrefix=(e,t={})=>{let n=e;return n.startsWith("./")&&(n=n.slice(2),t.prefix="./"),n},e.wrapOutput=(e,t={},n={})=>{let r=`${n.contains?"":"^"}(?:${e})${n.contains?"":"$"}`;return!0===t.negated&&(r=`(?:^(?!${r}).*$)`),r}}(_e);const ve=_e,{CHAR_ASTERISK:be,CHAR_AT:Se,CHAR_BACKWARD_SLASH:xe,CHAR_COMMA:He,CHAR_DOT:$e,CHAR_EXCLAMATION_MARK:Te,CHAR_FORWARD_SLASH:Le,CHAR_LEFT_CURLY_BRACE:Oe,CHAR_LEFT_PARENTHESES:we,CHAR_LEFT_SQUARE_BRACKET:ke,CHAR_PLUS:Ne,CHAR_QUESTION_MARK:Ie,CHAR_RIGHT_CURLY_BRACE:Me,CHAR_RIGHT_PARENTHESES:Pe,CHAR_RIGHT_SQUARE_BRACKET:Be}=me,De=e=>e===Le||e===xe,Ge=e=>{!0!==e.isPrefix&&(e.depth=e.isGlobstar?1/0:1)};var Ue=(e,t)=>{const n=t||{},r=e.length-1,o=!0===n.parts||!0===n.scanToEnd,s=[],a=[],i=[];let u,p,l=e,c=-1,f=0,d=0,g=!1,h=!1,A=!1,R=!1,_=!1,y=!1,E=!1,C=!1,m=!1,v=!1,b=0,S={value:"",depth:0,isGlob:!1};const x=()=>c>=r,H=()=>(u=p,l.charCodeAt(++c));for(;c<r;){let e;if(p=H(),p!==xe){if(!0===y||p===Oe){for(b++;!0!==x()&&(p=H());)if(p!==xe)if(p!==Oe){if(!0!==y&&p===$e&&(p=H())===$e){if(g=S.isBrace=!0,A=S.isGlob=!0,v=!0,!0===o)continue;break}if(!0!==y&&p===He){if(g=S.isBrace=!0,A=S.isGlob=!0,v=!0,!0===o)continue;break}if(p===Me&&(b--,0===b)){y=!1,g=S.isBrace=!0,v=!0;break}}else b++;else E=S.backslashes=!0,H();if(!0===o)continue;break}if(p!==Le){if(!0!==n.noext){if(!0===(p===Ne||p===Se||p===be||p===Ie||p===Te)&&l.charCodeAt(c+1)===we){if(A=S.isGlob=!0,R=S.isExtglob=!0,v=!0,p===Te&&c===f&&(m=!0),!0===o){for(;!0!==x()&&(p=H());)if(p!==xe){if(p===Pe){A=S.isGlob=!0,v=!0;break}}else E=S.backslashes=!0,p=H();continue}break}}if(p===be){if(u===be&&(_=S.isGlobstar=!0),A=S.isGlob=!0,v=!0,!0===o)continue;break}if(p===Ie){if(A=S.isGlob=!0,v=!0,!0===o)continue;break}if(p===ke){for(;!0!==x()&&(e=H());)if(e!==xe){if(e===Be){h=S.isBracket=!0,A=S.isGlob=!0,v=!0;break}}else E=S.backslashes=!0,H();if(!0===o)continue;break}if(!0===n.nonegate||p!==Te||c!==f){if(!0!==n.noparen&&p===we){if(A=S.isGlob=!0,!0===o){for(;!0!==x()&&(p=H());)if(p!==we){if(p===Pe){v=!0;break}}else E=S.backslashes=!0,p=H();continue}break}if(!0===A){if(v=!0,!0===o)continue;break}}else C=S.negated=!0,f++}else{if(s.push(c),a.push(S),S={value:"",depth:0,isGlob:!1},!0===v)continue;if(u===$e&&c===f+1){f+=2;continue}d=c+1}}else E=S.backslashes=!0,p=H(),p===Oe&&(y=!0)}!0===n.noext&&(R=!1,A=!1);let $=l,T="",L="";f>0&&(T=l.slice(0,f),l=l.slice(f),d-=f),$&&!0===A&&d>0?($=l.slice(0,d),L=l.slice(d)):!0===A?($="",L=l):$=l,$&&""!==$&&"/"!==$&&$!==l&&De($.charCodeAt($.length-1))&&($=$.slice(0,-1)),!0===n.unescape&&(L&&(L=ve.removeBackslashes(L)),$&&!0===E&&($=ve.removeBackslashes($)));const O={prefix:T,input:e,start:f,base:$,glob:L,isBrace:g,isBracket:h,isGlob:A,isExtglob:R,isGlobstar:_,negated:C,negatedExtglob:m};if(!0===n.tokens&&(O.maxDepth=0,De(p)||a.push(S),O.tokens=a),!0===n.parts||!0===n.tokens){let t;for(let r=0;r<s.length;r++){const o=t?t+1:f,u=s[r],p=e.slice(o,u);n.tokens&&(0===r&&0!==f?(a[r].isPrefix=!0,a[r].value=T):a[r].value=p,Ge(a[r]),O.maxDepth+=a[r].depth),0===r&&""===p||i.push(p),t=u}if(t&&t+1<e.length){const r=e.slice(t+1);i.push(r),n.tokens&&(a[a.length-1].value=r,Ge(a[a.length-1]),O.maxDepth+=a[a.length-1].depth)}O.slashes=s,O.parts=i}return O};const Ke=me,Fe=_e,{MAX_LENGTH:We,POSIX_REGEX_SOURCE:Qe,REGEX_NON_SPECIAL_CHARS:qe,REGEX_SPECIAL_CHARS_BACKREF:Xe,REPLACEMENTS:je}=Ke,Ze=(e,t)=>{if("function"==typeof t.expandRange)return t.expandRange(...e,t);e.sort();const n=`[${e.join("-")}]`;try{new RegExp(n)}catch(t){return e.map((e=>Fe.escapeRegex(e))).join("..")}return n},Ye=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,ze=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");e=je[e]||e;const n={...t},r="number"==typeof n.maxLength?Math.min(We,n.maxLength):We;let o=e.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);const s={type:"bos",value:"",output:n.prepend||""},a=[s],i=n.capture?"":"?:",u=Fe.isWindows(t),p=Ke.globChars(u),l=Ke.extglobChars(p),{DOT_LITERAL:c,PLUS_LITERAL:f,SLASH_LITERAL:d,ONE_CHAR:g,DOTS_SLASH:h,NO_DOT:A,NO_DOT_SLASH:R,NO_DOTS_SLASH:_,QMARK:y,QMARK_NO_DOT:E,STAR:C,START_ANCHOR:m}=p,v=e=>`(${i}(?:(?!${m}${e.dot?h:c}).)*?)`,b=n.dot?"":A,S=n.dot?y:E;let x=!0===n.bash?v(n):C;n.capture&&(x=`(${x})`),"boolean"==typeof n.noext&&(n.noextglob=n.noext);const H={input:e,index:-1,start:0,dot:!0===n.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=Fe.removePrefix(e,H),o=e.length;const $=[],T=[],L=[];let O,w=s;const k=()=>H.index===o-1,N=H.peek=(t=1)=>e[H.index+t],I=H.advance=()=>e[++H.index]||"",M=()=>e.slice(H.index+1),P=(e="",t=0)=>{H.consumed+=e,H.index+=t},B=e=>{H.output+=null!=e.output?e.output:e.value,P(e.value)},D=()=>{let e=1;for(;"!"===N()&&("("!==N(2)||"?"===N(3));)I(),H.start++,e++;return e%2!=0&&(H.negated=!0,H.start++,!0)},G=e=>{H[e]++,L.push(e)},U=e=>{H[e]--,L.pop()},K=e=>{if("globstar"===w.type){const t=H.braces>0&&("comma"===e.type||"brace"===e.type),n=!0===e.extglob||$.length&&("pipe"===e.type||"paren"===e.type);"slash"===e.type||"paren"===e.type||t||n||(H.output=H.output.slice(0,-w.output.length),w.type="star",w.value="*",w.output=x,H.output+=w.output)}if($.length&&"paren"!==e.type&&($[$.length-1].inner+=e.value),(e.value||e.output)&&B(e),w&&"text"===w.type&&"text"===e.type)return w.value+=e.value,void(w.output=(w.output||"")+e.value);e.prev=w,a.push(e),w=e},F=(e,t)=>{const r={...l[t],conditions:1,inner:""};r.prev=w,r.parens=H.parens,r.output=H.output;const o=(n.capture?"(":"")+r.open;G("parens"),K({type:e,value:t,output:H.output?"":g}),K({type:"paren",extglob:!0,value:I(),output:o}),$.push(r)},W=e=>{let t,r=e.close+(n.capture?")":"");if("negate"===e.type){let o=x;e.inner&&e.inner.length>1&&e.inner.includes("/")&&(o=v(n)),(o!==x||k()||/^\)+$/.test(M()))&&(r=e.close=`)$))${o}`),e.inner.includes("*")&&(t=M())&&/^\.[^\\/.]+$/.test(t)&&(r=e.close=`)${t})${o})`),"bos"===e.prev.type&&(H.negatedExtglob=!0)}K({type:"paren",extglob:!0,value:O,output:r}),U("parens")};if(!1!==n.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(e)){let r=!1,o=e.replace(Xe,((e,t,n,o,s,a)=>"\\"===o?(r=!0,e):"?"===o?t?t+o+(s?y.repeat(s.length):""):0===a?S+(s?y.repeat(s.length):""):y.repeat(n.length):"."===o?c.repeat(n.length):"*"===o?t?t+o+(s?x:""):x:t?e:`\\${e}`));return!0===r&&(o=!0===n.unescape?o.replace(/\\/g,""):o.replace(/\\+/g,(e=>e.length%2==0?"\\\\":e?"\\":""))),o===e&&!0===n.contains?(H.output=e,H):(H.output=Fe.wrapOutput(o,H,t),H)}for(;!k();){if(O=I(),"\0"===O)continue;if("\\"===O){const e=N();if("/"===e&&!0!==n.bash)continue;if("."===e||";"===e)continue;if(!e){O+="\\",K({type:"text",value:O});continue}const t=/^\\+/.exec(M());let r=0;if(t&&t[0].length>2&&(r=t[0].length,H.index+=r,r%2!=0&&(O+="\\")),!0===n.unescape?O=I():O+=I(),0===H.brackets){K({type:"text",value:O});continue}}if(H.brackets>0&&("]"!==O||"["===w.value||"[^"===w.value)){if(!1!==n.posix&&":"===O){const e=w.value.slice(1);if(e.includes("[")&&(w.posix=!0,e.includes(":"))){const e=w.value.lastIndexOf("["),t=w.value.slice(0,e),n=w.value.slice(e+2),r=Qe[n];if(r){w.value=t+r,H.backtrack=!0,I(),s.output||1!==a.indexOf(w)||(s.output=g);continue}}}("["===O&&":"!==N()||"-"===O&&"]"===N())&&(O=`\\${O}`),"]"!==O||"["!==w.value&&"[^"!==w.value||(O=`\\${O}`),!0===n.posix&&"!"===O&&"["===w.value&&(O="^"),w.value+=O,B({value:O});continue}if(1===H.quotes&&'"'!==O){O=Fe.escapeRegex(O),w.value+=O,B({value:O});continue}if('"'===O){H.quotes=1===H.quotes?0:1,!0===n.keepQuotes&&K({type:"text",value:O});continue}if("("===O){G("parens"),K({type:"paren",value:O});continue}if(")"===O){if(0===H.parens&&!0===n.strictBrackets)throw new SyntaxError(Ye("opening","("));const e=$[$.length-1];if(e&&H.parens===e.parens+1){W($.pop());continue}K({type:"paren",value:O,output:H.parens?")":"\\)"}),U("parens");continue}if("["===O){if(!0!==n.nobracket&&M().includes("]"))G("brackets");else{if(!0!==n.nobracket&&!0===n.strictBrackets)throw new SyntaxError(Ye("closing","]"));O=`\\${O}`}K({type:"bracket",value:O});continue}if("]"===O){if(!0===n.nobracket||w&&"bracket"===w.type&&1===w.value.length){K({type:"text",value:O,output:`\\${O}`});continue}if(0===H.brackets){if(!0===n.strictBrackets)throw new SyntaxError(Ye("opening","["));K({type:"text",value:O,output:`\\${O}`});continue}U("brackets");const e=w.value.slice(1);if(!0===w.posix||"^"!==e[0]||e.includes("/")||(O=`/${O}`),w.value+=O,B({value:O}),!1===n.literalBrackets||Fe.hasRegexChars(e))continue;const t=Fe.escapeRegex(w.value);if(H.output=H.output.slice(0,-w.value.length),!0===n.literalBrackets){H.output+=t,w.value=t;continue}w.value=`(${i}${t}|${w.value})`,H.output+=w.value;continue}if("{"===O&&!0!==n.nobrace){G("braces");const e={type:"brace",value:O,output:"(",outputIndex:H.output.length,tokensIndex:H.tokens.length};T.push(e),K(e);continue}if("}"===O){const e=T[T.length-1];if(!0===n.nobrace||!e){K({type:"text",value:O,output:O});continue}let t=")";if(!0===e.dots){const e=a.slice(),r=[];for(let t=e.length-1;t>=0&&(a.pop(),"brace"!==e[t].type);t--)"dots"!==e[t].type&&r.unshift(e[t].value);t=Ze(r,n),H.backtrack=!0}if(!0!==e.comma&&!0!==e.dots){const n=H.output.slice(0,e.outputIndex),r=H.tokens.slice(e.tokensIndex);e.value=e.output="\\{",O=t="\\}",H.output=n;for(const e of r)H.output+=e.output||e.value}K({type:"brace",value:O,output:t}),U("braces"),T.pop();continue}if("|"===O){$.length>0&&$[$.length-1].conditions++,K({type:"text",value:O});continue}if(","===O){let e=O;const t=T[T.length-1];t&&"braces"===L[L.length-1]&&(t.comma=!0,e="|"),K({type:"comma",value:O,output:e});continue}if("/"===O){if("dot"===w.type&&H.index===H.start+1){H.start=H.index+1,H.consumed="",H.output="",a.pop(),w=s;continue}K({type:"slash",value:O,output:d});continue}if("."===O){if(H.braces>0&&"dot"===w.type){"."===w.value&&(w.output=c);const e=T[T.length-1];w.type="dots",w.output+=O,w.value+=O,e.dots=!0;continue}if(H.braces+H.parens===0&&"bos"!==w.type&&"slash"!==w.type){K({type:"text",value:O,output:c});continue}K({type:"dot",value:O,output:c});continue}if("?"===O){if(!(w&&"("===w.value)&&!0!==n.noextglob&&"("===N()&&"?"!==N(2)){F("qmark",O);continue}if(w&&"paren"===w.type){const e=N();let t=O;if("<"===e&&!Fe.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===w.value&&!/[!=<:]/.test(e)||"<"===e&&!/<([!=]|\w+>)/.test(M()))&&(t=`\\${O}`),K({type:"text",value:O,output:t});continue}if(!0!==n.dot&&("slash"===w.type||"bos"===w.type)){K({type:"qmark",value:O,output:E});continue}K({type:"qmark",value:O,output:y});continue}if("!"===O){if(!0!==n.noextglob&&"("===N()&&("?"!==N(2)||!/[!=<:]/.test(N(3)))){F("negate",O);continue}if(!0!==n.nonegate&&0===H.index){D();continue}}if("+"===O){if(!0!==n.noextglob&&"("===N()&&"?"!==N(2)){F("plus",O);continue}if(w&&"("===w.value||!1===n.regex){K({type:"plus",value:O,output:f});continue}if(w&&("bracket"===w.type||"paren"===w.type||"brace"===w.type)||H.parens>0){K({type:"plus",value:O});continue}K({type:"plus",value:f});continue}if("@"===O){if(!0!==n.noextglob&&"("===N()&&"?"!==N(2)){K({type:"at",extglob:!0,value:O,output:""});continue}K({type:"text",value:O});continue}if("*"!==O){"$"!==O&&"^"!==O||(O=`\\${O}`);const e=qe.exec(M());e&&(O+=e[0],H.index+=e[0].length),K({type:"text",value:O});continue}if(w&&("globstar"===w.type||!0===w.star)){w.type="star",w.star=!0,w.value+=O,w.output=x,H.backtrack=!0,H.globstar=!0,P(O);continue}let t=M();if(!0!==n.noextglob&&/^\([^?]/.test(t)){F("star",O);continue}if("star"===w.type){if(!0===n.noglobstar){P(O);continue}const r=w.prev,o=r.prev,s="slash"===r.type||"bos"===r.type,a=o&&("star"===o.type||"globstar"===o.type);if(!0===n.bash&&(!s||t[0]&&"/"!==t[0])){K({type:"star",value:O,output:""});continue}const i=H.braces>0&&("comma"===r.type||"brace"===r.type),u=$.length&&("pipe"===r.type||"paren"===r.type);if(!s&&"paren"!==r.type&&!i&&!u){K({type:"star",value:O,output:""});continue}for(;"/**"===t.slice(0,3);){const n=e[H.index+4];if(n&&"/"!==n)break;t=t.slice(3),P("/**",3)}if("bos"===r.type&&k()){w.type="globstar",w.value+=O,w.output=v(n),H.output=w.output,H.globstar=!0,P(O);continue}if("slash"===r.type&&"bos"!==r.prev.type&&!a&&k()){H.output=H.output.slice(0,-(r.output+w.output).length),r.output=`(?:${r.output}`,w.type="globstar",w.output=v(n)+(n.strictSlashes?")":"|$)"),w.value+=O,H.globstar=!0,H.output+=r.output+w.output,P(O);continue}if("slash"===r.type&&"bos"!==r.prev.type&&"/"===t[0]){const e=void 0!==t[1]?"|$":"";H.output=H.output.slice(0,-(r.output+w.output).length),r.output=`(?:${r.output}`,w.type="globstar",w.output=`${v(n)}${d}|${d}${e})`,w.value+=O,H.output+=r.output+w.output,H.globstar=!0,P(O+I()),K({type:"slash",value:"/",output:""});continue}if("bos"===r.type&&"/"===t[0]){w.type="globstar",w.value+=O,w.output=`(?:^|${d}|${v(n)}${d})`,H.output=w.output,H.globstar=!0,P(O+I()),K({type:"slash",value:"/",output:""});continue}H.output=H.output.slice(0,-w.output.length),w.type="globstar",w.output=v(n),w.value+=O,H.output+=w.output,H.globstar=!0,P(O);continue}const r={type:"star",value:O,output:x};!0!==n.bash?!w||"bracket"!==w.type&&"paren"!==w.type||!0!==n.regex?(H.index!==H.start&&"slash"!==w.type&&"dot"!==w.type||("dot"===w.type?(H.output+=R,w.output+=R):!0===n.dot?(H.output+=_,w.output+=_):(H.output+=b,w.output+=b),"*"!==N()&&(H.output+=g,w.output+=g)),K(r)):(r.output=O,K(r)):(r.output=".*?","bos"!==w.type&&"slash"!==w.type||(r.output=b+r.output),K(r))}for(;H.brackets>0;){if(!0===n.strictBrackets)throw new SyntaxError(Ye("closing","]"));H.output=Fe.escapeLast(H.output,"["),U("brackets")}for(;H.parens>0;){if(!0===n.strictBrackets)throw new SyntaxError(Ye("closing",")"));H.output=Fe.escapeLast(H.output,"("),U("parens")}for(;H.braces>0;){if(!0===n.strictBrackets)throw new SyntaxError(Ye("closing","}"));H.output=Fe.escapeLast(H.output,"{"),U("braces")}if(!0===n.strictSlashes||"star"!==w.type&&"bracket"!==w.type||K({type:"maybe_slash",value:"",output:`${d}?`}),!0===H.backtrack){H.output="";for(const e of H.tokens)H.output+=null!=e.output?e.output:e.value,e.suffix&&(H.output+=e.suffix)}return H};ze.fastpaths=(e,t)=>{const n={...t},r="number"==typeof n.maxLength?Math.min(We,n.maxLength):We,o=e.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);e=je[e]||e;const s=Fe.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:i,ONE_CHAR:u,DOTS_SLASH:p,NO_DOT:l,NO_DOTS:c,NO_DOTS_SLASH:f,STAR:d,START_ANCHOR:g}=Ke.globChars(s),h=n.dot?c:l,A=n.dot?f:l,R=n.capture?"":"?:";let _=!0===n.bash?".*?":d;n.capture&&(_=`(${_})`);const y=e=>!0===e.noglobstar?_:`(${R}(?:(?!${g}${e.dot?p:a}).)*?)`,E=e=>{switch(e){case"*":return`${h}${u}${_}`;case".*":return`${a}${u}${_}`;case"*.*":return`${h}${_}${a}${u}${_}`;case"*/*":return`${h}${_}${i}${u}${A}${_}`;case"**":return h+y(n);case"**/*":return`(?:${h}${y(n)}${i})?${A}${u}${_}`;case"**/*.*":return`(?:${h}${y(n)}${i})?${A}${_}${a}${u}${_}`;case"**/.*":return`(?:${h}${y(n)}${i})?${a}${u}${_}`;default:{const t=/^(.*?)\.(\w+)$/.exec(e);if(!t)return;const n=E(t[1]);if(!n)return;return n+a+t[2]}}},C=Fe.removePrefix(e,{negated:!1,prefix:""});let m=E(C);return m&&!0!==n.strictSlashes&&(m+=`${i}?`),m};var Ve=ze;const Je=a.default,et=Ue,tt=Ve,nt=_e,rt=me,ot=(e,t,n=!1)=>{if(Array.isArray(e)){const r=e.map((e=>ot(e,t,n)));return e=>{for(const t of r){const n=t(e);if(n)return n}return!1}}const r=(o=e)&&"object"==typeof o&&!Array.isArray(o)&&e.tokens&&e.input;var o;if(""===e||"string"!=typeof e&&!r)throw new TypeError("Expected pattern to be a non-empty string");const s=t||{},a=nt.isWindows(t),i=r?ot.compileRe(e,t):ot.makeRe(e,t,!1,!0),u=i.state;delete i.state;let p=()=>!1;if(s.ignore){const e={...t,ignore:null,onMatch:null,onResult:null};p=ot(s.ignore,e,n)}const l=(n,r=!1)=>{const{isMatch:o,match:l,output:c}=ot.test(n,i,t,{glob:e,posix:a}),f={glob:e,state:u,regex:i,posix:a,input:n,output:c,match:l,isMatch:o};return"function"==typeof s.onResult&&s.onResult(f),!1===o?(f.isMatch=!1,!!r&&f):p(n)?("function"==typeof s.onIgnore&&s.onIgnore(f),f.isMatch=!1,!!r&&f):("function"==typeof s.onMatch&&s.onMatch(f),!r||f)};return n&&(l.state=u),l};ot.test=(e,t,n,{glob:r,posix:o}={})=>{if("string"!=typeof e)throw new TypeError("Expected input to be a string");if(""===e)return{isMatch:!1,output:""};const s=n||{},a=s.format||(o?nt.toPosixSlashes:null);let i=e===r,u=i&&a?a(e):e;return!1===i&&(u=a?a(e):e,i=u===r),!1!==i&&!0!==s.capture||(i=!0===s.matchBase||!0===s.basename?ot.matchBase(e,t,n,o):t.exec(u)),{isMatch:Boolean(i),match:i,output:u}},ot.matchBase=(e,t,n,r=nt.isWindows(n))=>(t instanceof RegExp?t:ot.makeRe(t,n)).test(Je.basename(e)),ot.isMatch=(e,t,n)=>ot(t,n)(e),ot.parse=(e,t)=>Array.isArray(e)?e.map((e=>ot.parse(e,t))):tt(e,{...t,fastpaths:!1}),ot.scan=(e,t)=>et(e,t),ot.compileRe=(e,t,n=!1,r=!1)=>{if(!0===n)return e.output;const o=t||{},s=o.contains?"":"^",a=o.contains?"":"$";let i=`${s}(?:${e.output})${a}`;e&&!0===e.negated&&(i=`^(?!${i}).*$`);const u=ot.toRegex(i,t);return!0===r&&(u.state=e),u},ot.makeRe=(e,t={},n=!1,r=!1)=>{if(!e||"string"!=typeof e)throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return!1===t.fastpaths||"."!==e[0]&&"*"!==e[0]||(o.output=tt.fastpaths(e,t)),o.output||(o=tt(e,t)),ot.compileRe(o,t,n,r)},ot.toRegex=(e,t)=>{try{const n=t||{};return new RegExp(e,n.flags||(n.nocase?"i":""))}catch(e){if(t&&!0===t.debug)throw e;return/$^/}},ot.constants=rt;var st=ot;const at=s.default,it=Re,ut=st,pt=_e,lt=e=>""===e||"./"===e,ct=(e,t,n)=>{t=[].concat(t),e=[].concat(e);let r=new Set,o=new Set,s=new Set,a=0,i=e=>{s.add(e.output),n&&n.onResult&&n.onResult(e)};for(let s=0;s<t.length;s++){let u=ut(String(t[s]),{...n,onResult:i},!0),p=u.state.negated||u.state.negatedExtglob;p&&a++;for(let t of e){let e=u(t,!0);(p?!e.isMatch:e.isMatch)&&(p?r.add(e.output):(r.delete(e.output),o.add(e.output)))}}let u=(a===t.length?[...s]:[...o]).filter((e=>!r.has(e)));if(n&&0===u.length){if(!0===n.failglob)throw new Error(`No matches found for "${t.join(", ")}"`);if(!0===n.nonull||!0===n.nullglob)return n.unescape?t.map((e=>e.replace(/\\/g,""))):t}return u};ct.match=ct,ct.matcher=(e,t)=>ut(e,t),ct.any=ct.isMatch=(e,t,n)=>ut(t,n)(e),ct.not=(e,t,n={})=>{t=[].concat(t).map(String);let r=new Set,o=[],s=ct(e,t,{...n,onResult:e=>{n.onResult&&n.onResult(e),o.push(e.output)}});for(let e of o)s.includes(e)||r.add(e);return[...r]},ct.contains=(e,t,n)=>{if("string"!=typeof e)throw new TypeError(`Expected a string: "${at.inspect(e)}"`);if(Array.isArray(t))return t.some((t=>ct.contains(e,t,n)));if("string"==typeof t){if(lt(e)||lt(t))return!1;if(e.includes(t)||e.startsWith("./")&&e.slice(2).includes(t))return!0}return ct.isMatch(e,t,{...n,contains:!0})},ct.matchKeys=(e,t,n)=>{if(!pt.isObject(e))throw new TypeError("Expected the first argument to be an object");let r=ct(Object.keys(e),t,n),o={};for(let t of r)o[t]=e[t];return o},ct.some=(e,t,n)=>{let r=[].concat(e);for(let e of[].concat(t)){let t=ut(String(e),n);if(r.some((e=>t(e))))return!0}return!1},ct.every=(e,t,n)=>{let r=[].concat(e);for(let e of[].concat(t)){let t=ut(String(e),n);if(!r.every((e=>t(e))))return!1}return!0},ct.all=(e,t,n)=>{if("string"!=typeof e)throw new TypeError(`Expected a string: "${at.inspect(e)}"`);return[].concat(t).every((t=>ut(t,n)(e)))},ct.capture=(e,t,n)=>{let r=pt.isWindows(n),o=ut.makeRe(String(e),{...n,capture:!0}).exec(r?pt.toPosixSlashes(t):t);if(o)return o.slice(1).map((e=>void 0===e?"":e))},ct.makeRe=(...e)=>ut.makeRe(...e),ct.scan=(...e)=>ut.scan(...e),ct.parse=(e,t)=>{let n=[];for(let r of[].concat(e||[]))for(let e of it(String(r),t))n.push(ut.parse(e,t));return n},ct.braces=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");return t&&!0===t.nobrace||!/\{.*\}/.test(e)?[e]:it(e,t)},ct.braceExpand=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");return ct.braces(e,{...t,expand:!0})};var ft=ct,dt={config:u.schema,async activate(){if(this.subscriptions=new e.CompositeDisposable,this.subscriptions.add(atom.commands.add("atom-workspace",{"linter-MakeNSIS:open-settings":()=>u.open()})),this.subscriptions.add(atom.commands.add("atom-workspace",{"linter-MakeNSIS:satisfy-dependencies":async()=>{const{satisfyDependencies:e}=await Promise.resolve().then((function(){return require("./index-7964059d.js")})).then((function(e){return e.index}));e(i)}})),!atom.inSpecMode()&&u.get("manageDependencies")){const{satisfyDependencies:e}=await Promise.resolve().then((function(){return require("./index-7964059d.js")})).then((function(e){return e.index}));e(i)}this.cleanUp()},deactivate(){this.subscriptions?.dispose(),this.subscriptions=null},cleanUp(){atom.config.unset("linter-makensis.ppoMode")},provideLinter:()=>({name:"linter-makensis",grammarScopes:["source.nsis"],scope:"file",lintsOnChange:u.get("lintsOnSave")||!1,lint:async e=>{const n=e.getPath(),r=u.get("excludedFiles")||[];if(r?.length&&ft.isMatch(n,r))return void l.log(`Skipping lint for ${n}, found in exclude list`);const o=e.getText(),s=u.get("advanced.preExecute"),a=u.get("advanced.postExecute"),i=!("win32"===t.platform()||!u.get("advanced.useWine")),p={preExecute:Array.isArray(s)?s:[],postExecute:Array.isArray(a)?a:[],PPO:null,safePPO:null,pathToMakensis:u.get("pathToMakensis"),strict:u.get("strictMode"),verbose:2,wine:i},c="win32"===t.platform()?"NUL":"/dev/null/";switch(String(u.get("preprocessMode")).trim()){case"PPO":p.PPO=!0;break;case"Safe PPO":p.safePPO=!0;break;default:p.postExecute.push(`OutFile ${c}`)}u.get("overrideCompression")&&(p.preExecute.unshift("SetCompressor /FINAL zlib"),p.postExecute.push("SetCompress off")),u.get("advanced.clearConsole")&&l.clear();const{compile:f}=await Promise.resolve().then((function(){return require("./makensis-559d2c12.js")})),d=await f(n,p);if(l.info("Compiler Options:",p),l.info("Output:",d),e.getText()!==o)return l.warn("File has changed since the lint was triggered"),null;const g=[];if(d.stdout){const{findWarnings:t}=await Promise.resolve().then((function(){return require("./util-dc8ba47a.js")})),n=await t(e,d.stdout,p);n&&g.push(...n)}if(d.stderr){const{findErrors:t}=await Promise.resolve().then((function(){return require("./util-dc8ba47a.js")})),n=await t(e,d.stderr);n&&g.push(...n)}return 0===g.length?null:g}})};exports.config=u,exports.index=dt,exports.name=i;
//# sourceMappingURL=index-f4ec529d.js.map
